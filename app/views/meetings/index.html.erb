<div class="container">
  <div style="width: 100%; height: 600px;"
    data-controller="map"
    data-map-markers-value="<%= @markers.to_json %>"
    data-map-api-key-value="<%= ENV['BONJOUR'] %>">
  </div>

  <div class="row text-center p-2" data-controller="show-filters">
    <button class="btn btn-primary mt-2 p-2 col-6 mx-auto rounded-pill"
            data-action="click->show-filters#display"
            data-show-filters-target="filtersButton"> 
            Filtres +
    </button>

    <div class="filter-form d-none " data-show-filters-target="showFilters">
      <%= form_with url: meetings_path, method: :get, local: true do %>
        <div class="col-md-12 my-2">
          <%= text_field_tag :search, params[:search], class: "form-control", placeholder: "Jeu, Catégorie, Adresse, Lieu, etc." %>
        </div>

        <div class="col-md-12">
          <%= submit_tag "Appliquer les filtres", class: "btn btn-success rounded-pill" %>
        </div>
      <% end %>
    </div>

    <h2 class="my-4">Liste des meetings</h2>
    <div class="meetings-container">
      <% @meetings.each do |meeting| %>
        <div class="meeting-card shadow rounded-4 row mb-3" style="overflow: hidden;">
          
          <div class="col-3 p-2 <%= meeting_status_class(meeting.status) %>" style="height: 100%;">
            <%= image_tag("profil.png", class: "img-fluid rounded-circle", style: 'height: 50px; width: 50px;') %>
            <p><%= meeting.date.strftime("%d/%m/%Y") %></p>
            <p><%= meeting.date.strftime("%H:%M") %></p>
          </div>
          
          
          <div class="col-9 p-2" style="height: 100%;">
            <h3><strong><%= meeting.game.name %></strong></h3>
            <p><%= meeting.title %></p>
            <p>Joueur : <%= meeting.players_needed_min %> 
              <% if !meeting.players_needed_max.blank? %>
                à <%= meeting.players_needed_max %></p>
              <% end %>
            
            <% if meeting.user != current_user %>
              <%= link_to "Je suis interressé", meeting_path(meeting) %>
            <% end %>
          </div>
        </div>
      <% end %>
    </div>
  </div>
</div>